# 第51条：谨慎设计方法签名

谨慎的选择方法的名称。方法的名称应该始终遵循标准的命名习惯。首要目的应该是选择易于理解的，并且与同一个包中的其他名称一致的名称。第二个目标应该是选择与大众认可的名称相一致的名称。如果还有疑问，请参考Java类库的API。尽管Java类库的API中也有大量不一致的地方，考虑到这些Java类库的规模和范围，这是不可避免地，但它们还是得到了相当程度地认可。

不要过于追求提供便利的方法。每个方法都应该尽其所能。方法太多会使类难以学习、使用、文档化、测试和维护。对于接口而言，这无疑使正确的，方法太多会使接口实现者和接口用户的工作变得复杂起来。对于类和接口所支持的每一个动作，都提供一个功能齐全的方法。只有当一项操作被经常用到的时候，才考虑为它提供快捷方式。如果不能确定，最好不要提供快捷方式。

避免过长的参数列表。目标是四个参数或者更少。大多数程序员都无法记住更长的参数列表。如果你编写的许多方法都超过了这个限制，你的API就不太便于使用，除非用户不停的参看它的文档。现代的IDE通过智能提示会有所帮助，但最好还是使用简短的参数列表。相同类型的长参数列表格外有害。API的用户不仅无法记住参数的顺序，而且，当它们不小心弄错了参数顺序时，程序依然可以编译和运行，只不过这些程序不会按照作者的意图进行工作。

有三种技巧可以缩短这个过程的参数列表。第一种是把一个方法分解成多个方法，每个方法只需要这些参数的一个子集。如果不小心，这样做会导致方法过多。但是通过提升它们的正交性，还可以减少方法的数目。例如，考虑java.util.List接口。它并没有提供在子列表中查找一个元素的第一个索引和最后一个索引的方法，这两个方法都需要三个参数。相反，它提供了subList方法，这个方法带有两个参数，并返回一个子列表的一个视图。这个方法可以与indexOf或者lastIndexOf方法结合起来，获得期望的功能，而这两个方法都分别只有一个参数。而且，subList方法也可以与其他任何“针对List实例进行操作”的方法结合起来，在子列表上执行任意的计算。这样的得到的API就有很高的功能-权重比。

缩短长参数列表的第二种技巧是创建辅助类，用来保存参数的分组。这些辅助类一般为静态成员类。如果一个频繁出现的参数序列可以被看作是代表了某个独特的实体，则建议使用这种方法。例如，假设你正在编写一个表示纸质牌的类，你会发现经常要传递一个双参数的序列来表示纸牌的点数和花色。如果增加辅助类来表示一张纸牌，并且把每个参数序列都换成这个类的单个参数，那么这个纸牌游戏类的API以及它的内部表示都可能会得到改进。

结合了前两种技巧特征的第三种技巧是，从对象构建到方法调用都采用Builder模式。如果方法带有多个参数，尤其是当他们中有些是可选的时候，最好定义一个对象来表示所有参数，并允许客户端在这个对象上进行多次“setter”调用，每次调用都设置一个参数，或者设置一个较小的相关的集合。一旦设置了有效的参数，客户端调用对象的“执行”方法，它对参数进行最终的有效性检查，并执行实际的计算。

对于参数类型，要优先使用接口而不是类。只要适当的接口可用来定义参数，就优先使用这个接口，而不是使用实现该接口的类。例如，没有理由在编写方法时使用HashMap类来作为输入，相反的应当使用Map接口作为参数。这使你可以传入一个Hashtable、HashMap、TreeMap、TreeMap的子映射表，或者任何有待于将来编写的Map实现。如果使用的是类而不是接口，则限制了客户端只能传入特定的实现，如果碰巧输入的数据是以其他的形式存在，就会导致不必要的、可能非常昂贵的拷贝操作。

对于boolean参数，要优先使用两个元素的枚举类型。它使代码更易于阅读和编写，尤其是当你在使用支持自动完成功能的IDE时。它也使以后更易于添加其他的选项。例如，你可能会有一个Thermometer类型，它带有一个静态工厂方法，而这个静态工厂方法的签名需要带有这个枚举的值：

```java
public enum ThermometerScale {FAHRENHEIT, CELSIUS}
```

Thermometer.newInstance(ThermometerScale.CELSIUS)不仅比Thermometer.newInstance(true)更有用，而且你还可以在未来的发行版本中将KELVIN添加到ThermometerScale中，无须为Thermometer添加新的静态工厂。你还可以将温度范围的依赖重构到枚举常量的方法中。例如，每个范围常量都可以有一个方法，它带有一个double值，并将它的规格化成摄氏度。